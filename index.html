<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- FIX: theme-color updated to match actual dark background (#0F172A not #000000) -->
    <meta name="theme-color" content="#0F172A" />
    <meta name="description" content="TNB Financial Management - Login Page" />
    <title>TNB - Login</title>
    <!-- FIX: Import Plus Jakarta Sans (used in CSS font-family but was never loaded) -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="login-style.css" />
    <link rel="manifest" href="manifest.json" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
      /* If user is already logged in, skip login page and go straight to dashboard */
      (async () => {
        try {
          const { createClient } = window.supabase;
          const sb = createClient(
            "https://lqfjeamzbxayfbjntarr.supabase.co",
            "sb_publishable_jDExXkASC_jrulY8B7noFw_r9qut-vQ"
          );
          const { data: { session } } = await sb.auth.getSession();
          if (session) {
            window.location.replace("dashboard.html");
          }
        } catch (_) { /* ignore â€” let user log in normally */ }
      })();
    </script>
  </head>
  <body class="dark-mode">

    <!-- FIX: Background orbs were defined in CSS but never added to HTML -->
    <div class="bg-orb bg-orb-1" aria-hidden="true"></div>
    <div class="bg-orb bg-orb-2" aria-hidden="true"></div>
    <div class="bg-orb bg-orb-3" aria-hidden="true"></div>

    <div class="glass-container">
      <div class="top-nav">
        <button id="lang-btn" class="sub-btn" aria-label="Change Language">
          <i class="fa-solid fa-language"></i> Burmese
        </button>
        <button onclick="location.href = 'register.html'" class="sub-btn">
          <i class="fa-solid fa-user-plus"></i> Sign Up
        </button>
        <button id="theme-btn" class="sub-btn">ðŸŒ™ Dark</button>
      </div>

      <!-- FIX: Brand mark section was in CSS but missing from HTML -->
      <div class="brand-mark">
        <div class="brand-icon" aria-hidden="true">
          <i class="fa-solid fa-chart-line"></i>
        </div>
        <span class="brand-name">TNB</span>
      </div>

      <div class="note-box">
        <!-- FIX: Note icon was styled in CSS (.note-icon) but missing from HTML -->
        <i class="fa-solid fa-circle-info note-icon" aria-hidden="true"></i>
        <p id="note-text">
          Welcome to the financial management software. We will always try to
          distinguish your assets and losses.
        </p>
      </div>

      <header>
        <h1 id="title">Login</h1>
        <p class="page-sub" id="page-sub">Sign in to your account</p>
      </header>

      <main>
        <form id="login-form">
          <!-- FIX: Input icons (.input-icon) were styled in CSS but missing from HTML -->
          <div class="input-group">
            <i class="fa-solid fa-user input-icon" aria-hidden="true"></i>
            <input
              type="text"
              id="username"
              placeholder="UserName"
              required
              autocomplete="username"
            />
          </div>
          <div class="input-group">
            <i class="fa-solid fa-lock input-icon" aria-hidden="true"></i>
            <input
              type="password"
              id="password"
              placeholder="Password"
              required
              autocomplete="current-password"
            />
            <!-- FIX: .toggle-pass was styled in CSS but the button was missing from HTML -->
            <button
              type="button"
              class="toggle-pass"
              id="toggle-pass"
              aria-label="Show or hide password"
            >
              <i class="fa-solid fa-eye" id="toggle-pass-icon"></i>
            </button>
          </div>
          <button type="submit" id="login-btn" class="main-btn">
            <i class="fa-solid fa-right-to-bracket"></i> Login
          </button>
        </form>

        <div class="separator"><span>Or</span></div>

        <!--
          FIX: Replaced all heavy inline styles with the .social-btn CSS class
          that is already defined in login-style.css. Inline styles were
          duplicating (and partially conflicting with) the existing CSS.
          Shimmer overlay kept as inline since it requires JS-toggled display.
        -->
        <button
          type="button"
          id="gmail-btn"
          class="social-btn"
          aria-label="Continue with Google"
        >
          <!-- Google G logo (official brand SVG) -->
          <svg
            class="google-icon"
            width="20" height="20"
            viewBox="0 0 48 48"
            aria-hidden="true"
          >
            <path fill="#EA4335" d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"/>
            <path fill="#4285F4" d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"/>
            <path fill="#FBBC05" d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"/>
            <path fill="#34A853" d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.18 1.48-4.97 2.36-8.16 2.36-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"/>
          </svg>

          <span id="gmail-btn-text">Continue with Google</span>

          <!-- Shimmer overlay â€” activated via JS while loading -->
          <span
            id="gmail-shimmer"
            style="
              display: none;
              position: absolute;
              inset: 0;
              background: linear-gradient(
                100deg,
                transparent 20%,
                rgba(255,255,255,0.15) 50%,
                transparent 80%
              );
              background-size: 200% 100%;
              animation: gmailShimmer 1.1s infinite linear;
              pointer-events: none;
              border-radius: 12px;
            "
          ></span>
        </button>

        <!-- Shimmer keyframe -->
        <style>
          @keyframes gmailShimmer {
            from { background-position: 200% 0; }
            to   { background-position: -200% 0; }
          }
        </style>

      </main>

      <footer class="footer-links">
        <p id="signup-text">
          If you don't have an account?
          <a href="register.html">Sign Up</a>
        </p>
        <p id="reset-text">
          Forgot password?
          <a href="reset.html">Reset Password</a>
        </p>
      </footer>
    </div>

    <script src="login-script.js"></script>
    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('sw.js').catch(() => {});
        });
      }
    </script>
  </body>
</html>
