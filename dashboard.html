<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TNB - Finance Dashboard</title>

    <link rel="manifest" href="manifest.json" />

    <link
      href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />

    <link rel="stylesheet" href="dashboard1.css" />
    <link rel="stylesheet" href="dashboard2.css" />

    <script>
      // Service Worker Registration for PWA
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", () => {
          navigator.serviceWorker
            .register("sw.js")
            .then(() => console.log("Dashboard Service Worker Registered"))
            .catch((err) => console.log("SW Registration Failed", err));
        });
      }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  </head>
  <body class="dark-mode">
    <div class="mobile-container">
      <header class="top-header">
        <button class="icon-btn" id="menu-btn" onclick="toggleSidebar()">
          <i class="fa-solid fa-grip-lines"></i>
        </button>
        <h2 class="app-logo">TNB</h2>
        <div class="header-right">
          <button id="theme-toggle" class="icon-btn">
            <i class="fas fa-circle-half-stroke"></i>
          </button>

          <div class="profile-container">
            <div class="profile-avatar" id="profile-btn">
              <img
                id="user-avatar"
                src="https://ui-avatars.com/api/?name=User&background=06b6d4&color=fff"
                alt="Profile"
              />
            </div>

            <div id="profile-dropdown" class="dropdown-menu">
              <div class="dropdown-header">
                <p id="user-display-name">User Name</p>
                <small id="user-display-email">user@email.com</small>
              </div>
              <hr style="opacity: 0.1; margin: 8px 0" />
              <button class="dropdown-item logout-red" id="logout-confirm-btn">
                <i class="fas fa-arrow-right-from-bracket"></i> Logout
              </button>
            </div>
          </div>
        </div>
      </header>

      <main class="content">
        <section class="balance-card">
          <span
            id="label-total-balance"
            style="
              font-weight: 600;
              text-transform: uppercase;
              font-size: 0.7rem;
              letter-spacing: 1px;
            "
            >Available Balance</span
          >
          <h1 id="main-balance">$0.00</h1>
          <div class="summary-row">
            <div class="summary-item income">
              <div class="icon-circle">
                <i class="fas fa-arrow-down-long"></i>
              </div>
              <div>
                <span id="label-income">Income</span>
                <p id="total-income">+$0</p>
              </div>
            </div>
            <div class="summary-item expense">
              <div class="icon-circle">
                <i class="fas fa-arrow-up-long"></i>
              </div>
              <div>
                <span id="label-expense">Expense</span>
                <p id="total-expense">-$0</p>
              </div>
            </div>
          </div>
        </section>

        <section class="quick-actions">
          <button class="action-btn" onclick="openModal('income')">
            <div class="icon-box green">
              <i class="fa-solid fa-plus-large"></i>+
            </div>
            <span id="qa-add-income">Income</span>
          </button>
          <button class="action-btn" onclick="openModal('expense')">
            <div class="icon-box red">
              <i class="fa-solid fa-minus-large"></i>-
            </div>
            <span id="qa-add-expense">Expense</span>
          </button>
          <button class="action-btn" onclick="navigateTo('history')">
            <div class="icon-box blue">
              <i class="fa-solid fa-clock-rotate-left"></i>
            </div>
            <span id="qa-history">History</span>
          </button>
          <button class="action-btn" onclick="navigateTo('reports')">
            <div class="icon-box purple">
              <i class="fa-solid fa-chart-line"></i>
            </div>
            <span id="qa-reports">Analysis</span>
          </button>
        </section>

        <h3 class="section-title" id="title-categories">Categories</h3>
        <div class="category-carousel">
          <div class="cat-card red" onclick="catAction('Expense', 'Food')">
            <div class="cat-icon-wrapper"><i class="fas fa-burger"></i></div>
            <p id="cat-food">Food</p>
          </div>
          <div class="cat-card blue" onclick="catAction('Expense', 'Health')">
            <div class="cat-icon-wrapper">
              <i class="fas fa-kit-medical"></i>
            </div>
            <p id="cat-health">Health</p>
          </div>
          <div
            class="cat-card purple"
            onclick="catAction('Expense', 'Shopping')"
          >
            <div class="cat-icon-wrapper">
              <i class="fas fa-bag-shopping"></i>
            </div>
            <p id="cat-shop">Shopping</p>
          </div>
          <div class="cat-card gold" onclick="catAction('Expense', 'Travel')">
            <div class="cat-icon-wrapper"><i class="fas fa-route"></i></div>
            <p id="cat-travel">Travel</p>
          </div>
          <div class="cat-card green" onclick="catAction('Income', 'Salary')">
            <div class="cat-icon-wrapper">
              <i class="fas fa-money-bill-trend-up"></i>
            </div>
            <p id="cat-salary">Salary</p>
          </div>
        </div>

        <div class="list-header">
          <h3 class="section-title" id="title-recent" style="margin-bottom: 0">
            Activity
          </h3>
          <button id="lang-toggle" class="lang-btn">EN / MY</button>
        </div>

        <div id="transaction-list" class="transaction-list"></div>
      </main>

      <div id="choice-modal" class="modal">
        <div class="modal-content choice-container">
          <h3 id="choice-title" style="text-align: center; margin-bottom: 20px">
            New Transaction
          </h3>
          <div class="choice-options">
            <button
              class="choice-btn income-choice"
              onclick="selectChoice('income')"
            >
              <i class="fas fa-plus-circle"></i>
              <span>Income</span>
            </button>
            <button
              class="choice-btn expense-choice"
              onclick="selectChoice('expense')"
            >
              <i class="fas fa-minus-circle"></i>
              <span>Expense</span>
            </button>
          </div>
          <button
            type="button"
            class="sub-btn"
            onclick="closeChoiceModal()"
            style="width: 100%"
          >
            Close
          </button>
        </div>
      </div>

      <div id="transaction-modal" class="modal">
        <div class="modal-content">
          <h3 id="modal-form-title">Enter Details</h3>
          <form id="transaction-form">
            <input type="hidden" id="trans-type" value="income" />

            <div class="input-group">
              <label id="lbl-amount">Amount</label>
              <input
                type="number"
                id="amount"
                placeholder="0.00"
                step="0.01"
                required
              />
            </div>

            <div class="input-group">
              <label id="label-category">Category</label>
              <select id="category" required>
                <optgroup label="─── INCOME ───" id="opt-income">
                  <option value="Salary">Salary</option>
                  <option value="Investment">Investment</option>
                  <option value="Bonus">Bonus</option>
                  <option value="Other">Other</option>
                </optgroup>
                <optgroup label="─── EXPENSE ───" id="opt-expense">
                  <option value="Shopping">Shopping</option>
                  <option value="Food">Food</option>
                  <option value="Health">Health</option>
                  <option value="Travel">Travel</option>
                  <option value="Bill">Bill</option>
                  <option value="Other">Other</option>
                </optgroup>
              </select>
            </div>

            <div class="input-group">
              <label id="lbl-note">Note</label>
              <input type="text" id="note" placeholder="Description..." />
            </div>

            <div class="modal-btns">
              <button type="submit" class="main-btn" id="save-btn">
                Confirm
              </button>
              <button type="button" class="sub-btn" onclick="closeModal()">
                Back
              </button>
            </div>
          </form>
        </div>
      </div>

      <nav class="bottom-nav">
        <button
          class="nav-item active"
          id="nav-dash-btn"
          onclick="navigateTo('dashboard')"
        >
          <i class="fas fa-house-chimney"></i><span id="nav-dash">Home</span>
        </button>
        <button
          class="nav-item"
          id="nav-hist-btn"
          onclick="navigateTo('history')"
        >
          <i class="fas fa-receipt"></i><span id="nav-hist">History</span>
        </button>

        <div class="add-placeholder"></div>
        <button class="nav-item add-circle" onclick="showChoiceModal()">
          <i class="fas fa-plus"></i>
        </button>

        <button
          class="nav-item"
          id="nav-rep-btn"
          onclick="navigateTo('reports')"
        >
          <i class="fas fa-chart-pie"></i><span id="nav-rep">Stats</span>
        </button>
        <button
          class="nav-item"
          id="nav-set-btn"
          onclick="navigateTo('settings')"
        >
          <i class="fas fa-sliders"></i><span id="nav-set">Settings</span>
        </button>
      </nav>
    </div>

    <script src="dashboard.js"></script>
  </body>
</html>
