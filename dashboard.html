<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TNB - Finance Dashboard</title>

    <link rel="manifest" href="manifest.json" />

    <link
      href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="stylesheet" href="dashboard.css" />

    <script>
      // Service Worker Registration for PWA
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", () => {
          navigator.serviceWorker
            .register("sw.js")
            .then(() => console.log("Dashboard Service Worker Registered"))
            .catch((err) => console.log("SW Registration Failed", err));
        });
      }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  </head>
  <body class="dark-mode">
    <div class="mobile-container">
      <header class="top-header">
        <button class="icon-btn" id="menu-btn" onclick="toggleSidebar()">
          <i class="fas fa-bars"></i>
        </button>
        <h2 class="app-logo">TNB</h2>
        <div class="header-right">
          <button id="theme-toggle" class="icon-btn">
            <i class="fas fa-moon"></i>
          </button>

          <div class="profile-container">
            <div class="profile-avatar" id="profile-btn">
              <img
                id="user-avatar"
                src="https://ui-avatars.com/api/?name=User&background=3b82f6&color=fff"
                alt="Profile"
              />
            </div>

            <div id="profile-dropdown" class="dropdown-menu">
              <div class="dropdown-header">
                <p id="user-display-name">User Name</p>
                <small id="user-display-email">user@email.com</small>
              </div>
              <hr />
              <button class="dropdown-item logout-red" id="logout-confirm-btn">
                <i class="fas fa-sign-out-alt"></i> Logout
              </button>
            </div>
          </div>
        </div>
      </header>

      <main class="content">
        <section class="balance-card">
          <p id="label-total-balance">Total Balance</p>
          <h1 id="main-balance">$0.00</h1>
          <div class="summary-row">
            <div class="summary-item income">
              <div class="icon-circle"><i class="fas fa-arrow-down"></i></div>
              <div>
                <span id="label-income">Income</span>
                <p id="total-income">+$0</p>
              </div>
            </div>
            <div class="summary-item expense">
              <div class="icon-circle"><i class="fas fa-arrow-up"></i></div>
              <div>
                <span id="label-expense">Expense</span>
                <p id="total-expense">-$0</p>
              </div>
            </div>
          </div>
        </section>

        <section class="quick-actions">
          <button class="action-btn" onclick="openModal('income')">
            <div class="icon-box green"><i class="fas fa-plus"></i></div>
            <span id="qa-add-income">Add Income</span>
          </button>
          <button class="action-btn" onclick="openModal('expense')">
            <div class="icon-box red"><i class="fas fa-minus"></i></div>
            <span id="qa-add-expense">Add Expense</span>
          </button>
          <button class="action-btn" onclick="navigateTo('history')">
            <div class="icon-box blue"><i class="fas fa-history"></i></div>
            <span id="qa-history">History</span>
          </button>
          <button class="action-btn" onclick="navigateTo('reports')">
            <div class="icon-box purple"><i class="fas fa-chart-pie"></i></div>
            <span id="qa-reports">Reports</span>
          </button>
        </section>

        <h3 class="section-title" id="title-categories">Categories</h3>
        <div class="category-carousel">
          <div class="cat-card gold" onclick="catAction('Expense', 'Food')">
            <i class="fas fa-utensils"></i>
            <p id="cat-food">Food</p>
          </div>
          <div class="cat-card blue" onclick="catAction('Expense', 'Shopping')">
            <i class="fas fa-shopping-bag"></i>
            <p id="cat-shop">Shopping</p>
          </div>
          <div class="cat-card green" onclick="catAction('Income', 'Salary')">
            <i class="fas fa-wallet"></i>
            <p id="cat-salary">Salary</p>
          </div>
        </div>

        <div class="list-header">
          <h3 class="section-title" id="title-recent">Recent Transactions</h3>
          <button id="lang-toggle" class="lang-btn">Burmese</button>
        </div>

        <div id="transaction-list" class="transaction-list"></div>
      </main>

      <div id="choice-modal" class="modal">
        <div class="modal-content choice-container">
          <h3 id="choice-title">Choose Type</h3>
          <div class="choice-options">
            <button
              class="choice-btn income-choice"
              onclick="selectChoice('income')"
            >
              <i class="fas fa-arrow-down"></i>
              <span>Add Income</span>
            </button>
            <button
              class="choice-btn expense-choice"
              onclick="selectChoice('expense')"
            >
              <i class="fas fa-arrow-up"></i>
              <span>Add Expense</span>
            </button>
          </div>
          <button type="button" class="sub-btn" onclick="closeChoiceModal()">
            Cancel
          </button>
        </div>
      </div>

      <div id="transaction-modal" class="modal">
        <div class="modal-content">
          <h3 id="modal-form-title">Add Transaction</h3>
          <form id="transaction-form">
            <input type="hidden" id="trans-type" value="income" />
            <div class="input-group">
              <label id="lbl-amount">Amount</label>
              <input
                type="number"
                id="amount"
                placeholder="0.00"
                step="0.01"
                required
              />
            </div>
            <div class="input-group">
              <label id="lbl-category">Category</label>
              <select id="category">
                <option value="Salary">Salary</option>
                <option value="Food">Food</option>
                <option value="Shopping">Shopping</option>
                <option value="Gift">Investment</option>
                <option value="Other">Other</option>
              </select>
            </div>
            <div class="input-group">
              <label id="lbl-note">Note</label>
              <input type="text" id="note" placeholder="What is this for?" />
            </div>
            <div class="modal-btns">
              <button type="submit" class="main-btn" id="save-btn">Save</button>
              <button type="button" class="sub-btn" onclick="closeModal()">
                Cancel
              </button>
            </div>
          </form>
        </div>
      </div>

      <nav class="bottom-nav">
        <button
          class="nav-item active"
          id="nav-dash-btn"
          onclick="navigateTo('dashboard')"
        >
          <i class="fas fa-home"></i><span id="nav-dash">Dashboard</span>
        </button>
        <button
          class="nav-item"
          id="nav-hist-btn"
          onclick="navigateTo('history')"
        >
          <i class="fas fa-list-ul"></i><span id="nav-hist">History</span>
        </button>
        <div class="add-placeholder"></div>
        <button class="nav-item add-circle" onclick="showChoiceModal()">
          <i class="fas fa-plus"></i>
        </button>
        <button
          class="nav-item"
          id="nav-rep-btn"
          onclick="navigateTo('reports')"
        >
          <i class="fas fa-chart-line"></i><span id="nav-rep">Reports</span>
        </button>
        <button
          class="nav-item"
          id="nav-set-btn"
          onclick="navigateTo('settings')"
        >
          <i class="fas fa-user-gear"></i><span id="nav-set">Settings</span>
        </button>
      </nav>
    </div>

    <script src="dashboard.js"></script>
  </body>
</html>
