<!doctype html>
<html lang="en" data-theme="dark">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no"
    />
    <title>TNB History</title>
    <link rel="stylesheet" href="history.css" />
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  </head>
  <body>
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     TOP NAVBAR
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <header class="cmd-bar" id="cmdBar">
      <!-- ‚îÄ‚îÄ ROW 1 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
      <div class="cmd-row cmd-row1">
        <!-- Back button -->
        <button class="back-btn" id="backBtn" aria-label="Back to Dashboard">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2">
            <polyline points="15 18 9 12 15 6" />
          </svg>
        </button>

        <div class="search-shell">
          <svg class="search-ico" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2">
            <circle cx="11" cy="11" r="8" />
            <line x1="21" y1="21" x2="16.65" y2="16.65" />
          </svg>
          <input
            class="search-input"
            id="searchInput"
            type="search"
            placeholder="Search transactions‚Ä¶"
            autocomplete="off"
          />
          <button class="search-clear" id="searchClear" aria-label="Clear search">‚úï</button>
        </div>

        <div class="nav-actions">
          <!-- Notification Bell -->
          <div class="bell-shell" id="bellShell">
            <button class="bell-btn" id="bellBtn" aria-label="Notifications" aria-expanded="false">
              <svg width="17" height="17" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9" />
                <path d="M13.73 21a2 2 0 01-3.46 0" />
              </svg>
              <span class="bell-dot" id="bellDot" style="display: none"></span>
            </button>
            <div class="notif-panel" id="notifPanel">
              <div class="np-head">
                <span class="np-title" data-i18n="notifications">Notifications</span>
                <button class="np-markread" id="npMarkRead">Mark all read</button>
                <button class="np-clear" id="npClear" data-i18n="clear_all">Clear All</button>
              </div>
              <div class="np-body" id="npBody">
                <p class="np-empty" id="npEmpty" data-i18n="no_notifs">No notifications yet</p>
              </div>
            </div>
          </div>

          <!-- 3-dots menu -->
          <div class="dots-shell" id="dotsShell">
            <button class="dots-btn" id="dotsBtn" aria-label="Menu" aria-expanded="false">
              <span></span><span></span><span></span>
            </button>
            <div class="dots-menu" id="dotsMenu" role="menu">
              <label class="dmenu-row dmenu-toggle" role="menuitem">
                <span class="dmenu-icon">üåô</span>
                <span class="dmenu-label" data-i18n="dark_mode">Dark Mode</span>
                <span class="dm-switch">
                  <input type="checkbox" id="themeCheck" checked />
                  <span class="dm-track"></span>
                </span>
              </label>
              <div class="dmenu-divider"></div>
              <button class="dmenu-row" id="menuAddIncome" role="menuitem">
                <span class="dmenu-icon income-ico">Ôºã</span>
                <span class="dmenu-label" data-i18n="add_income">Add Income</span>
              </button>
              <button class="dmenu-row" id="menuAddExpense" role="menuitem">
                <span class="dmenu-icon expense-ico">Ôºç</span>
                <span class="dmenu-label" data-i18n="add_expense">Add Expense</span>
              </button>
              <div class="dmenu-divider"></div>
              <button class="dmenu-row" id="menuLang" role="menuitem">
                <span class="dmenu-icon">üåê</span>
                <span class="dmenu-label" id="menuLangLabel">Switch to ·Äô·Äº·Äî·Ä∫·Äô·Ä¨</span>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- ‚îÄ‚îÄ ROW 2 ‚Äî Financial Summary ‚îÄ‚îÄ -->
      <div class="cmd-row cmd-row2">
        <div class="summary-strip">
          <div class="ss-item ss-balance">
            <span class="ss-label" data-i18n="available_balance">Balance</span>
            <span class="ss-val balance-col" id="r2Balance">$0.00</span>
          </div>
          <div class="ss-sep"></div>
          <div class="ss-item">
            <span class="ss-label" data-i18n="income">Income</span>
            <span class="ss-val income-col" id="r2Income">$0.00</span>
          </div>
          <div class="ss-sep"></div>
          <div class="ss-item">
            <span class="ss-label" data-i18n="expense">Expense</span>
            <span class="ss-val expense-col" id="r2Expense">$0.00</span>
          </div>
        </div>
      </div>
    </header>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     MAIN CONTENT ‚Äî ALL TRANSACTIONS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <main class="app-main" id="appMain">

      <!-- SEARCH RESULTS -->
      <section class="page hidden" id="page-search">
        <div class="page-head">
          <h2 class="page-title" id="searchResultLabel">Results</h2>
        </div>
        <div class="txn-feed" id="searchFeed"></div>
      </section>

      <!-- ALL TRANSACTIONS PAGE -->
      <section class="page active" id="page-transactions">
        <div class="page-head">
          <h2 class="page-title" data-i18n="all_transactions">All Transactions</h2>
        </div>

        <!-- Advanced filter panel -->
        <div class="adv-filter-panel" id="advFilterPanel">
          <!-- Type filter -->
          <div class="afp-row">
            <span class="afp-label" data-i18n="filter_type">Type</span>
            <div class="filter-tabs" id="txnTabs">
              <button class="ftab active" data-filter="all" data-i18n="all">All</button>
              <button class="ftab" data-filter="income" data-i18n="income">Income</button>
              <button class="ftab" data-filter="expense" data-i18n="expense">Expense</button>
            </div>
          </div>
          <!-- Date range filter -->
          <div class="afp-row afp-dates">
            <div class="afp-date-group">
              <label class="afp-label" data-i18n="start_date">From</label>
              <input type="date" class="date-pick" id="txnDateFrom" />
            </div>
            <div class="afp-date-group">
              <label class="afp-label" data-i18n="end_date">To</label>
              <input type="date" class="date-pick" id="txnDateTo" />
            </div>
          </div>
          <!-- Error message -->
          <div class="afp-error" id="afpError" style="display: none"></div>
          <!-- Actions -->
          <div class="afp-actions">
            <button class="afp-apply" id="afpApply" data-i18n="apply_filter">Apply Filter</button>
            <button class="afp-reset" id="afpReset" data-i18n="reset_filter">Reset</button>
            <button class="csv-btn" id="csvBtnTxn">
              <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2">
                <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4" />
                <polyline points="7 10 12 15 17 10" />
                <line x1="12" y1="15" x2="12" y2="3" />
              </svg>
              <span data-i18n="export_csv">Export CSV</span>
            </button>
          </div>
          <!-- Active filter indicator -->
          <div class="afp-active-badge" id="afpActiveBadge" style="display: none">
            <span id="afpActiveText"></span>
            <button class="afp-badge-clear" id="afpBadgeClear">‚úï</button>
          </div>
        </div>

        <div class="txn-feed" id="txnFeed"></div>
      </section>
    </main>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     BOTTOM NAVIGATION BAR
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <nav class="bot-nav" id="botNav">
      <button class="bn-btn" onclick="location.href='dashboard.html'" id="bn-dashboard">
        <svg class="bn-ico" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
          <rect x="3" y="3" width="7" height="7" rx="1.5" />
          <rect x="14" y="3" width="7" height="7" rx="1.5" />
          <rect x="3" y="14" width="7" height="7" rx="1.5" />
          <rect x="14" y="14" width="7" height="7" rx="1.5" />
        </svg>
        <span class="bn-lbl" data-i18n="nav_dashboard">Home</span>
      </button>

      <button class="bn-btn active" id="bn-transactions">
        <svg class="bn-ico" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
          <path d="M8 6h13M8 12h13M8 18h13M3 6h.01M3 12h.01M3 18h.01" />
        </svg>
        <span class="bn-lbl" data-i18n="nav_transactions">History</span>
      </button>

      <!-- Centre FAB ‚Äî Add Transaction -->
      <div class="fab-zone">
        <button class="fab-main" id="fabMain" aria-label="Add transaction">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
            <line x1="12" y1="5" x2="12" y2="19" />
            <line x1="5" y1="12" x2="19" y2="12" />
          </svg>
        </button>
        <div class="fab-sub" id="fabSub">
          <button class="fab-sub-btn fab-income" id="fabIncome">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
              <polyline points="18 15 12 9 6 15" />
            </svg>
            <span data-i18n="add_income">Income</span>
          </button>
          <button class="fab-sub-btn fab-expense" id="fabExpense">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
              <polyline points="6 9 12 15 18 9" />
            </svg>
            <span data-i18n="add_expense">Expense</span>
          </button>
        </div>
        <div class="fab-backdrop" id="fabBackdrop"></div>
      </div>

      <button class="bn-btn" onclick="location.href='dashboard.html#reports'" id="bn-reports">
        <svg class="bn-ico" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
          <path d="M18 20V10M12 20V4M6 20v-6" />
        </svg>
        <span class="bn-lbl" data-i18n="reports">Reports</span>
      </button>

      <button class="bn-btn" onclick="location.href='dashboard.html#settings'" id="bn-settings">
        <svg class="bn-ico" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
          <circle cx="12" cy="12" r="3" />
          <path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-4 0v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 010-4h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 012.83-2.83l.06.06A1.65 1.65 0 009 4.68a1.65 1.65 0 001-1.51V3a2 2 0 014 0v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 2.83l-.06.06A1.65 1.65 0 0019.4 9a1.65 1.65 0 001.51 1H21a2 2 0 010 4h-.09a1.65 1.65 0 00-1.51 1z" />
        </svg>
        <span class="bn-lbl" data-i18n="nav_settings">Settings</span>
      </button>
    </nav>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     MODALS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div class="modal-veil" id="txnVeil">
      <div class="modal-card" id="txnCard">
        <div class="mc-head">
          <h2 class="mc-title" id="mcTitle">Add Income</h2>
          <button class="mc-close" id="mcClose">‚úï</button>
        </div>
        <div class="mc-body">
          <input type="hidden" id="txnType" value="income" />
          <div class="field">
            <label class="field-lbl" data-i18n="amount">Amount ($)</label>
            <div class="amount-wrap">
              <span class="amt-prefix">$</span>
              <input
                type="number"
                class="field-input amt-input"
                id="txnAmount"
                placeholder="0.00"
                min="0.01"
                step="0.01"
                inputmode="decimal"
              />
            </div>
          </div>
          <div class="field">
            <label class="field-lbl" data-i18n="category">Category</label>
            <select class="field-input" id="txnCategory"></select>
          </div>
          <div class="field">
            <label class="field-lbl" data-i18n="description">Description</label>
            <input type="text" class="field-input" id="txnDesc" placeholder="e.g. Monthly salary" />
          </div>
          <div class="field">
            <label class="field-lbl" data-i18n="date">Date</label>
            <input type="date" class="field-input" id="txnDate" />
          </div>
          <button class="submit-btn" id="txnSubmit" data-i18n="add_transaction">Add Transaction</button>
        </div>
      </div>
    </div>

    <div class="modal-veil" id="cfmVeil">
      <div class="modal-card cfm-card">
        <div class="cfm-icon">‚ö†Ô∏è</div>
        <h3 class="cfm-title" id="cfmTitle">Are you sure?</h3>
        <p class="cfm-msg" id="cfmMsg">This cannot be undone.</p>
        <div class="cfm-btns">
          <button class="cfm-cancel" id="cfmCancel" data-i18n="cancel">Cancel</button>
          <button class="danger-btn cfm-ok" id="cfmOk" data-i18n="confirm">Confirm</button>
        </div>
      </div>
    </div>

    <!-- Toast notifications -->
    <div class="toast-container" id="toastContainer"></div>

    <script src="history.js"></script>
  </body>
</html>
